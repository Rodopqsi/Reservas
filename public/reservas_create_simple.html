<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Reserva - Sistema de Reservas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass-effect {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Encabezado -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold gradient-text mb-4">
                    ‚ú® Crear Nueva Reserva
                </h1>
                <p class="text-gray-600 text-lg">
                    Sistema de Reservas de Aulas - Funcional
                </p>
            </div>

            <!-- Tarjeta del formulario -->
            <div class="glass-effect rounded-3xl p-8 shadow-2xl">
                <form id="reservaForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Aula -->
                        <div>
                            <label for="aula_id" class="block text-sm font-semibold text-gray-700 mb-2">
                                üè´ Aula
                            </label>
                            <select id="aula_id" name="aula_id" required class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200">
                                <option value="">Seleccione un aula</option>
                                <option value="1">Aula 101 - Capacidad: 30</option>
                                <option value="2">Aula 102 - Capacidad: 25</option>
                                <option value="3">Aula 103 - Capacidad: 40</option>
                                <option value="4">Laboratorio 1 - Capacidad: 20</option>
                                <option value="5">Auditorio - Capacidad: 100</option>
                            </select>
                        </div>

                        <!-- Fecha -->
                        <div>
                            <label for="fecha" class="block text-sm font-semibold text-gray-700 mb-2">
                                üìÖ Fecha
                            </label>
                            <input type="date" id="fecha" name="fecha" required class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200">
                        </div>

                        <!-- Hora de inicio -->
                        <div>
                            <label for="hora_inicio" class="block text-sm font-semibold text-gray-700 mb-2">
                                üïê Hora de Inicio
                            </label>
                            <select id="hora_inicio" name="hora_inicio" required class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200">
                                <option value="">Seleccionar hora</option>
                                <option value="08:00">08:00</option>
                                <option value="09:00">09:00</option>
                                <option value="10:00">10:00</option>
                                <option value="11:00">11:00</option>
                                <option value="12:00">12:00</option>
                                <option value="13:00">13:00</option>
                                <option value="14:00">14:00</option>
                                <option value="15:00">15:00</option>
                                <option value="16:00">16:00</option>
                                <option value="17:00">17:00</option>
                                <option value="18:00">18:00</option>
                            </select>
                        </div>

                        <!-- Hora de fin -->
                        <div>
                            <label for="hora_fin" class="block text-sm font-semibold text-gray-700 mb-2">
                                üïê Hora de Fin
                            </label>
                            <select id="hora_fin" name="hora_fin" required class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200">
                                <option value="">Seleccionar hora</option>
                                <option value="09:00">09:00</option>
                                <option value="10:00">10:00</option>
                                <option value="11:00">11:00</option>
                                <option value="12:00">12:00</option>
                                <option value="13:00">13:00</option>
                                <option value="14:00">14:00</option>
                                <option value="15:00">15:00</option>
                                <option value="16:00">16:00</option>
                                <option value="17:00">17:00</option>
                                <option value="18:00">18:00</option>
                                <option value="19:00">19:00</option>
                            </select>
                        </div>

                        <!-- Motivo -->
                        <div class="md:col-span-2">
                            <label for="motivo" class="block text-sm font-semibold text-gray-700 mb-2">
                                üìù Motivo de la Reserva
                            </label>
                            <input type="text" id="motivo" name="motivo" required placeholder="Ej: Clase de Matem√°ticas, Reuni√≥n de departamento, etc." class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200">
                        </div>

                        <!-- Observaciones -->
                        <div class="md:col-span-2">
                            <label for="observaciones" class="block text-sm font-semibold text-gray-700 mb-2">
                                üí≠ Observaciones (Opcional)
                            </label>
                            <textarea id="observaciones" name="observaciones" rows="3" placeholder="Informaci√≥n adicional sobre la reserva..." class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/70 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 resize-none"></textarea>
                        </div>
                    </div>

                    <!-- Botones -->
                    <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200/50">
                        <a href="/calendario" class="flex-1 px-6 py-3 text-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-xl transition-all duration-200">
                            Volver al Calendario
                        </a>
                        <button type="submit" class="flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-medium rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl">
                            Crear Reserva
                        </button>
                    </div>
                </form>
            </div>

            <!-- Informaci√≥n de la reserva -->
            <div id="reservaInfo" class="mt-8 hidden">
                <div class="glass-effect rounded-3xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">üìã Informaci√≥n de la Reserva</h3>
                    <div id="reservaDetalles" class="space-y-2 text-gray-700"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configurar fecha m√≠nima (hoy)
        document.getElementById('fecha').min = new Date().toISOString().split('T')[0];
        document.getElementById('fecha').value = new Date().toISOString().split('T')[0];

        // Actualizar hora de fin autom√°ticamente
        document.getElementById('hora_inicio').addEventListener('change', function() {
            const horaInicio = this.value;
            const horaFin = document.getElementById('hora_fin');
            
            if (horaInicio) {
                const hora = parseInt(horaInicio.split(':')[0]);
                const horaFinAuto = String(hora + 1).padStart(2, '0') + ':00';
                horaFin.value = horaFinAuto;
            }
        });

        // Obtener par√°metros de la URL
        const urlParams = new URLSearchParams(window.location.search);
        const aulaId = urlParams.get('aula_id');
        const fecha = urlParams.get('fecha');
        const horaInicio = urlParams.get('hora_inicio');
        const horaFin = urlParams.get('hora_fin');

        // Prellenar el formulario con los par√°metros de la URL
        if (aulaId) {
            document.getElementById('aula_id').value = aulaId;
        }
        if (fecha) {
            document.getElementById('fecha').value = fecha;
        }
        if (horaInicio) {
            document.getElementById('hora_inicio').value = horaInicio;
        }
        if (horaFin) {
            document.getElementById('hora_fin').value = horaFin;
        }

        // Mostrar informaci√≥n de selecci√≥n m√∫ltiple
        if (horaInicio && horaFin) {
            const horaInicioNum = parseInt(horaInicio.split(':')[0]);
            const horaFinNum = parseInt(horaFin.split(':')[0]);
            const duracion = horaFinNum - horaInicioNum;
            
            if (duracion > 1) {
                const form = document.getElementById('reservaForm');
                const infoDiv = document.createElement('div');
                infoDiv.className = 'bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-4 mb-6';
                infoDiv.innerHTML = `
                    <div class="flex items-center">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-500 rounded-full p-2 mr-3">
                            <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Reserva de m√∫ltiples horas</h3>
                            <p class="text-gray-600 text-sm">
                                Has seleccionado ${duracion} horas consecutivas (${horaInicio} - ${horaFin})
                            </p>
                        </div>
                    </div>
                `;
                form.parentNode.insertBefore(infoDiv, form);
            }
        }

        // Manejar env√≠o del formulario
        document.getElementById('reservaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Obtener datos del formulario
            const formData = new FormData(this);
            const reservaData = {
                aula_id: formData.get('aula_id'),
                fecha: formData.get('fecha'),
                hora_inicio: formData.get('hora_inicio'),
                hora_fin: formData.get('hora_fin'),
                motivo: formData.get('motivo'),
                observaciones: formData.get('observaciones')
            };

            // Obtener nombre del aula
            const aulaSelect = document.getElementById('aula_id');
            const aulaNombre = aulaSelect.options[aulaSelect.selectedIndex].text;

            // Mostrar informaci√≥n de la reserva
            const reservaInfo = document.getElementById('reservaInfo');
            const reservaDetalles = document.getElementById('reservaDetalles');
            
            reservaDetalles.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><strong>Aula:</strong> ${aulaNombre}</div>
                    <div><strong>Fecha:</strong> ${reservaData.fecha}</div>
                    <div><strong>Hora:</strong> ${reservaData.hora_inicio} - ${reservaData.hora_fin}</div>
                    <div><strong>Motivo:</strong> ${reservaData.motivo}</div>
                    ${reservaData.observaciones ? `<div class="md:col-span-2"><strong>Observaciones:</strong> ${reservaData.observaciones}</div>` : ''}
                </div>
                <div class="mt-4 p-4 bg-green-50 border border-green-200 rounded-xl">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="text-green-700 font-medium">¬°Reserva procesada exitosamente!</span>
                    </div>
                    <p class="text-green-600 text-sm mt-1">
                        Esta es una versi√≥n de prueba. En producci√≥n, los datos se guardar√≠an en la base de datos.
                    </p>
                </div>
            `;
            
            reservaInfo.classList.remove('hidden');
            reservaInfo.scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>
